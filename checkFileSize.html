<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
		<input type="file" name="contractFileName" id="aaa" style="width: 500px;" onchange="fileChange(this,'aaa');"/>  
		<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
		<script type="text/javascript">
			var isIE = /msie/i.test(navigator.userAgent) && !window.opera;
			function fileChange(target,id) {  
		        var fileSize = 0;          
		        if (isIE && !target.files) {      
		              var filePath = target.value;     
		              var fileSystem = new ActiveXObject("Scripting.FileSystemObject");  
		              if(!fileSystem.FileExists(filePath)){  
		                 alert("附件不存在，请重新输入！");  
		                 var file=document.getElementById(id);   
		                 file.outerHTML=file.outerHTML;  
		                 return;  
		              }  
		              var file = fileSystem.GetFile (filePath);  
		              fileSize = file.Size;     
		        } else {     
		              fileSize = target.files[0].size;   
		        }    
		        //注  fileSize 的单位是字节 byte 
		        //下面是转换成KB  如果要转化成MB 还需再除以一个1024
		        var size = fileSize / 1024;   
		        if(size>100){   
		             alert("附件大小不能大于100KM！");   
		             var file=document.getElementById(id);   
		             file.outerHTML=file.outerHTML;  
		        }    
		        if(size<=0){  
		            alert("附件大小不能为0 KB！");   
		            var file=document.getElementById(id);   
		             file.outerHTML=file.outerHTML;  
		        }   
		     } 
		</script>
	</body>
</html>
